  <div id="C00000104">
<div class='banner'>
  <span class="file-title-prefix">Module</span><br />UsersHelper<br/>
  In:
<a href="#" onclick="jsHref('files/app/helpers/users_helper_rb.html');">app/helpers/users_helper.rb</a>

</div>
 <!-- banner header -->

  <div id="bodyContent" >
      <div id="content">




  <div class="sectiontitle">Methods</div>
  <ul>
  <li><a href="index.html?a=M000106&name=if_authorized?" >if_authorized?</a></li>
  <li><a href="index.html?a=M000109&name=link_to_current_user" >link_to_current_user</a></li>
  <li><a href="index.html?a=M000108&name=link_to_login_with_IP" >link_to_login_with_IP</a></li>
  <li><a href="index.html?a=M000107&name=link_to_user" >link_to_user</a></li>
  </ul>






<div class="sectiontitle">Public Instance methods</div>
<div id="M000106" class="method">
  <div id="M000106_title" class="title">
    <b>if_authorized?</b>(action, resource) {|action, resource| ...}
  </div>
  <div class="description">
  <p>
Use this to wrap view elements that the user can&#8217;t access. !! Note:
this is an <b>interface</b>, not <b>security</b> feature !! You need to do
all access control at the controller level.
</p>
<p>
Example: &lt;%= <a
href="index.html?a=M000106&name=if_authorized?">if_authorized?</a>(:index,
<a href="index.html?a=C00000074&name=User">User</a>) do link_to(&#8216;List
all users&#8217;, users_path) end %&gt; | &lt;%= <a
href="index.html?a=M000106&name=if_authorized?">if_authorized?</a>(:edit,
@user) do link_to(&#8216;Edit this user&#8217;, edit_user_path) end %&gt; |
&lt;%= <a
href="index.html?a=M000106&name=if_authorized?">if_authorized?</a>(:destroy,
@user) do link_to &#8216;Destroy&#8217;, @user, :confirm =&gt; &#8216;Are
you sure?&#8217;, :method =&gt; :delete end %&gt;
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000106_source')" id="l_M000106_source">show source</a> ]</p>
  <div id="M000106_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File app/helpers/users_helper.rb, line 51</span>
51:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">if_authorized?</span>(<span class="ruby-identifier">action</span>, <span class="ruby-identifier">resource</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
52:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">authorized?</span>(<span class="ruby-identifier">action</span>, <span class="ruby-identifier">resource</span>)
53:       <span class="ruby-keyword kw">yield</span> <span class="ruby-identifier">action</span>, <span class="ruby-identifier">resource</span>
54:     <span class="ruby-keyword kw">end</span>
55:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000109" class="method">
  <div id="M000109_title" class="title">
    <b>link_to_current_user</b>(options={})
  </div>
  <div class="description">
  <p>
Link to the current user&#8217;s page (using <a
href="index.html?a=M000107&name=link_to_user">link_to_user</a>) or to the
login page (using <a
href="index.html?a=M000108&name=link_to_login_with_IP">link_to_login_with_IP</a>).
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000109_source')" id="l_M000109_source">show source</a> ]</p>
  <div id="M000109_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File app/helpers/users_helper.rb, line 119</span>
119:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">link_to_current_user</span>(<span class="ruby-identifier">options</span>={})
120:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">current_user</span>
121:       <span class="ruby-identifier">link_to_user</span> <span class="ruby-identifier">current_user</span>, <span class="ruby-identifier">options</span>
122:     <span class="ruby-keyword kw">else</span>
123:       <span class="ruby-identifier">content_text</span> = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">:content_text</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">_</span>(<span class="ruby-value str">'not signed in'</span>)
124:       <span class="ruby-comment cmt"># kill ignored options from link_to_user</span>
125:       [<span class="ruby-identifier">:content_method</span>, <span class="ruby-identifier">:title_method</span>].<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">opt</span><span class="ruby-operator">|</span> <span class="ruby-identifier">options</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">opt</span>)} 
126:       <span class="ruby-identifier">link_to_login_with_IP</span> <span class="ruby-identifier">content_text</span>, <span class="ruby-identifier">options</span>
127:     <span class="ruby-keyword kw">end</span>
128:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000108" class="method">
  <div id="M000108_title" class="title">
    <b>link_to_login_with_IP</b>(content_text=nil, options={})
  </div>
  <div class="description">
  <p>
Link to login page using remote ip address as link content
</p>
<p>
The :title (and thus, tooltip) is set to the IP address
</p>
<p>
Examples:
</p>
<pre>
  link_to_login_with_IP
  # =&gt; &lt;a href=&quot;/login&quot; title=&quot;169.69.69.69&quot;&gt;169.69.69.69&lt;/a&gt;

  link_to_login_with_IP :content_text =&gt; 'not signed in'
  # =&gt; &lt;a href=&quot;/login&quot; title=&quot;169.69.69.69&quot;&gt;not signed in&lt;/a&gt;
</pre>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000108_source')" id="l_M000108_source">show source</a> ]</p>
  <div id="M000108_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File app/helpers/users_helper.rb, line 104</span>
104:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">link_to_login_with_IP</span> <span class="ruby-identifier">content_text</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">options</span>={}
105:     <span class="ruby-identifier">ip_addr</span>           = <span class="ruby-identifier">request</span>.<span class="ruby-identifier">remote_ip</span>
106:     <span class="ruby-identifier">content_text</span>    <span class="ruby-operator">||=</span> <span class="ruby-identifier">ip_addr</span>
107:     <span class="ruby-identifier">options</span>.<span class="ruby-identifier">reverse_merge!</span> <span class="ruby-identifier">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">ip_addr</span>
108:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">tag</span> = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">:tag</span>)
109:       <span class="ruby-identifier">content_tag</span> <span class="ruby-identifier">tag</span>, <span class="ruby-identifier">h</span>(<span class="ruby-identifier">content_text</span>), <span class="ruby-identifier">options</span>
110:     <span class="ruby-keyword kw">else</span>
111:       <span class="ruby-identifier">link_to</span> <span class="ruby-identifier">h</span>(<span class="ruby-identifier">content_text</span>), <span class="ruby-identifier">login_path</span>, <span class="ruby-identifier">options</span>
112:     <span class="ruby-keyword kw">end</span>
113:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000107" class="method">
  <div id="M000107_title" class="title">
    <b>link_to_user</b>(user, options={})
  </div>
  <div class="description">
  <p>
Link to user&#8217;s page (&#8216;users/1&#8217;)
</p>
<p>
By default, their login is used as link text and link title (tooltip)
</p>
<p>
Takes options
</p>
<ul>
<li>:content_text =&gt; &#8216;Content text in place of user.login&#8217;,
escaped with the standard h() function.

</li>
<li>:content_method =&gt; :user_instance_method_to_call_for_content_text

</li>
<li>:title_method =&gt; :user_instance_method_to_call_for_title_attribute

</li>
<li>as well as link_to()&#8217;s standard options

</li>
</ul>
<p>
Examples:
</p>
<pre>
  link_to_user @user
  # =&gt; &lt;a href=&quot;/users/3&quot; title=&quot;barmy&quot;&gt;barmy&lt;/a&gt;

  # if you've added a .name attribute:
 content_tag :span, :class =&gt; :vcard do
   (link_to_user user, :class =&gt; 'fn n', :title_method =&gt; :login, :content_method =&gt; :name) +
         ': ' + (content_tag :span, user.email, :class =&gt; 'email')
  end
  # =&gt; &lt;span class=&quot;vcard&quot;&gt;&lt;a href=&quot;/users/3&quot; title=&quot;barmy&quot; class=&quot;fn n&quot;&gt;Cyril Fotheringay-Phipps&lt;/a&gt;: &lt;span class=&quot;email&quot;&gt;barmy@blandings.com&lt;/span&gt;&lt;/span&gt;

  link_to_user @user, :content_text =&gt; 'Your user page'
  # =&gt; &lt;a href=&quot;/users/3&quot; title=&quot;barmy&quot; class=&quot;nickname&quot;&gt;Your user page&lt;/a&gt;
</pre>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000107_source')" id="l_M000107_source">show source</a> ]</p>
  <div id="M000107_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File app/helpers/users_helper.rb, line 83</span>
83:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">link_to_user</span>(<span class="ruby-identifier">user</span>, <span class="ruby-identifier">options</span>={})
84:     <span class="ruby-identifier">raise</span> <span class="ruby-identifier">_</span>(<span class="ruby-value str">&quot;Invalid user&quot;</span>) <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">user</span>
85:     <span class="ruby-identifier">options</span>.<span class="ruby-identifier">reverse_merge!</span> <span class="ruby-identifier">:content_method</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:login</span>, <span class="ruby-identifier">:title_method</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:login</span>, <span class="ruby-identifier">:class</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:nickname</span>
86:     <span class="ruby-identifier">content_text</span>      = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">:content_text</span>)
87:     <span class="ruby-identifier">content_text</span>    <span class="ruby-operator">||=</span> <span class="ruby-identifier">user</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">options</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">:content_method</span>))
88:     <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:title</span>] <span class="ruby-operator">||=</span> <span class="ruby-identifier">user</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">options</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">:title_method</span>))
89:     <span class="ruby-identifier">link_to</span> <span class="ruby-identifier">h</span>(<span class="ruby-identifier">content_text</span>), <span class="ruby-identifier">user_path</span>(<span class="ruby-identifier">user</span>), <span class="ruby-identifier">options</span>
90:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
</div>

  </div>